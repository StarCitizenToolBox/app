name: "Windows Nightly Build"
on:
    schedule:
        - cron: "0 0 * * *" # every day at midnight
    workflow_dispatch:    
jobs:
    build:
        runs-on: windows-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v2
            - name: Set up Flutter
              uses: subosito/flutter-action@v2
              with:
               channel: 'stable'
            - run: flutter --version
            - name: Set up Rust
              uses: dtolnay/rust-toolchain@stable
            - run: rustup --version  
            - run: cargo --version
            - name: Set up LLVM
              uses: KyleMayes/install-llvm-action@v1
              with:
               version: "17.0.2"
            - name: Clean Git Cache
              run: rm -rf /c/Users/runneradmin/.pub-cache/git/*
            - name: Flutter pub get
              run: flutter pub get  
            - name: Set up Flutter rust bridge
              run: cargo install 'flutter_rust_bridge_codegen@^2.0.0-dev.0'  
            - name: Rust bridge generate
              run: flutter_rust_bridge_codegen generate
            - name: flutter gen l10n
              run: flutter pub run intl_utils:generate  
            - name: Flutter build Windows
              run: flutter build windows
            - name: Archive build
              uses: actions/upload-artifact@v4
              with:
                name: windows
                path: build/windows/x64/runner/Release
                